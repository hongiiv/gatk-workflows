2018-10-11 14:59:27,097 INFO  - 2d7df48f-0239-42a5-8508-5f47e858badd-SubWorkflowActor-SubWorkflow-PreProcessTumor:-1:1 [UUID(2d7df48f)]: Starting PreProcessingForVariantDiscovery_GATK4.CreateSequenceGroupingTSV, PreProcessingForVariantDiscovery_GATK4.GetBwaVersion
2018-10-11 14:59:29,737 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.GetBwaVersion:NA:1]: `# Not setting "set -o pipefail" here because /bwa has a rc=1 and we don't want to allow rc=1 to succeed 
# because the sed may also fail with that error and that is something we actually want to fail on.
/usr/gitc/bwa 2>&1 | \
grep -e '^Version' | \
sed 's/Version: //'`
2018-10-11 14:59:29,748 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.CreateSequenceGroupingTSV:NA:1]: `python <<CODE
with open("/cromwell_root/gatk-legacy-bundles/b37/human_g1k_v37_decoy.dict", "r") as ref_dict_file:
    sequence_tuple_list = []
    longest_sequence = 0
    for line in ref_dict_file:
        if line.startswith("@SQ"):
            line_split = line.split("\t")
            # (Sequence_Name, Sequence_Length)
            sequence_tuple_list.append((line_split[1].split("SN:")[1], int(line_split[2].split("LN:")[1])))
    longest_sequence = sorted(sequence_tuple_list, key=lambda x: x[1], reverse=True)[0][1]
# We are adding this to the intervals because hg38 has contigs named with embedded colons (:) and a bug in 
# some versions of GATK strips off the last element after a colon, so we add this as a sacrificial element.
hg38_protection_tag = ":1+"
# initialize the tsv string with the first sequence
tsv_string = sequence_tuple_list[0][0] + hg38_protection_tag
temp_size = sequence_tuple_list[0][1]
for sequence_tuple in sequence_tuple_list[1:]:
    if temp_size + sequence_tuple[1] <= longest_sequence:
        temp_size += sequence_tuple[1]
        tsv_string += "\t" + sequence_tuple[0] + hg38_protection_tag
    else:
        tsv_string += "\n" + sequence_tuple[0] + hg38_protection_tag
        temp_size = sequence_tuple[1]
# add the unmapped sequences as a separate line to ensure that they are recalibrated as well
with open("sequence_grouping.txt","w") as tsv_file:
  tsv_file.write(tsv_string)
  tsv_file.close()

tsv_string += '\n' + "unmapped"

with open("sequence_grouping_with_unmapped.txt","w") as tsv_file_with_unmapped:
  tsv_file_with_unmapped.write(tsv_string)
  tsv_file_with_unmapped.close()
CODE`
2018-10-11 14:59:31,247 INFO  - 2d7df48f-0239-42a5-8508-5f47e858badd-SubWorkflowActor-SubWorkflow-PreProcessTumor:-1:1 [UUID(2d7df48f)]: Starting PreProcessingForVariantDiscovery_GATK4.SamToFastqAndBwaMem
2018-10-11 14:59:31,846 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.SamToFastqAndBwaMem:0:1]: `  set -o pipefail
  set -e

  # set the bash variable needed for the command-line
  bash_ref_fasta=/cromwell_root/gatk-legacy-bundles/b37/human_g1k_v37_decoy.fasta

java -Dsamjdk.compression_level=5 -Xms3000m -jar /usr/gitc/picard.jar \
    SamToFastq \
	INPUT=/cromwell_root/ngb_cloud/cromwell-execution/FullPipeline/6c26de66-1dd8-419f-9f44-b4620fa457da/call-PreProcessFastqs/PreProcessFastq.ConvertPairedFastQsToUnmappedBamWf/b400cacc-14c0-4c25-a3f4-537fe7d99b98/call-PairedFastQsToUnmappedBAM/shard-0/NGB0-075-KOD-NEB-18-2.unmapped.bam \
	FASTQ=/dev/stdout \
	INTERLEAVE=true \
	NON_PF=true \
  | \
/usr/gitc/bwa mem -K 100000000 -p -v 3 -t 16 -Y $bash_ref_fasta /dev/stdin -  2> >(tee NGB0-075-KOD-NEB-18-2.unmapped.unmerged.bwa.stderr.log >&2) \
  | \
samtools view -1 - > NGB0-075-KOD-NEB-18-2.unmapped.unmerged.bam`
2018-10-11 14:59:55,883 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.CreateSequenceGroupingTSV:NA:1]: job id: operations/ENmT143mLBij797swO716MoBIMiRiJ3_CyoPcHJvZHVjdGlvblF1ZXVl
2018-10-11 14:59:55,883 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.GetBwaVersion:NA:1]: job id: operations/EJ-T143mLBit0KbjqbqHzOcBIMiRiJ3_CyoPcHJvZHVjdGlvblF1ZXVl
2018-10-11 14:59:55,883 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.SamToFastqAndBwaMem:0:1]: job id: operations/EJ-T143mLBjJn6mj9abJ16cBIMiRiJ3_CyoPcHJvZHVjdGlvblF1ZXVl
2018-10-11 15:00:28,201 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.GetBwaVersion:NA:1]: Status change from - to Running
2018-10-11 15:00:28,212 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.SamToFastqAndBwaMem:0:1]: Status change from - to Running
2018-10-11 15:00:28,215 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.CreateSequenceGroupingTSV:NA:1]: Status change from - to Running
2018-10-11 15:01:36,170 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.CreateSequenceGroupingTSV:NA:1]: Status change from Running to Success
2018-10-11 15:03:50,195 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.GetBwaVersion:NA:1]: Status change from Running to Success
2018-10-11 15:04:57,405 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.SamToFastqAndBwaMem:0:1]: Status change from Running to Success
2018-10-11 15:04:59,307 INFO  - 2d7df48f-0239-42a5-8508-5f47e858badd-SubWorkflowActor-SubWorkflow-PreProcessTumor:-1:1 [UUID(2d7df48f)]: Starting PreProcessingForVariantDiscovery_GATK4.MergeBamAlignment
2018-10-11 15:05:01,730 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.MergeBamAlignment:0:1]: `# set the bash variable needed for the command-line
bash_ref_fasta=/cromwell_root/gatk-legacy-bundles/b37/human_g1k_v37_decoy.fasta
/gatk/gatk --java-options "-Dsamjdk.compression_level=5 -Xms3000m" \
  MergeBamAlignment \
  --VALIDATION_STRINGENCY SILENT \
  --EXPECTED_ORIENTATIONS FR \
  --ATTRIBUTES_TO_RETAIN X0 \
  --ALIGNED_BAM /cromwell_root/ngb_cloud/cromwell-execution/FullPipeline/6c26de66-1dd8-419f-9f44-b4620fa457da/call-PreProcessTumor/PreProcess.PreProcessingForVariantDiscovery_GATK4/2d7df48f-0239-42a5-8508-5f47e858badd/call-SamToFastqAndBwaMem/shard-0/NGB0-075-KOD-NEB-18-2.unmapped.unmerged.bam \
  --UNMAPPED_BAM /cromwell_root/ngb_cloud/cromwell-execution/FullPipeline/6c26de66-1dd8-419f-9f44-b4620fa457da/call-PreProcessFastqs/PreProcessFastq.ConvertPairedFastQsToUnmappedBamWf/b400cacc-14c0-4c25-a3f4-537fe7d99b98/call-PairedFastQsToUnmappedBAM/shard-0/NGB0-075-KOD-NEB-18-2.unmapped.bam \
  --OUTPUT NGB0-075-KOD-NEB-18-2.unmapped.aligned.unsorted.bam \
  --REFERENCE_SEQUENCE /cromwell_root/gatk-legacy-bundles/b37/human_g1k_v37_decoy.fasta \
  --PAIRED_RUN true \
  --SORT_ORDER "unsorted" \
  --IS_BISULFITE_SEQUENCE false \
  --ALIGNED_READS_ONLY false \
  --CLIP_ADAPTERS false \
  --MAX_RECORDS_IN_RAM 2000000 \
  --ADD_MATE_CIGAR true \
  --MAX_INSERTIONS_OR_DELETIONS -1 \
  --PRIMARY_ALIGNMENT_STRATEGY MostDistant \
  --PROGRAM_RECORD_ID "bwamem" \
  --PROGRAM_GROUP_VERSION "0.7.15-r1140" \
  --PROGRAM_GROUP_COMMAND_LINE "bwa mem -K 100000000 -p -v 3 -t 16 -Y $bash_ref_fasta" \
  --PROGRAM_GROUP_NAME "bwamem" \
  --UNMAPPED_READ_STRATEGY COPY_TO_TAG \
  --ALIGNER_PROPER_PAIR_FLAGS true \
  --UNMAP_CONTAMINANT_READS true`
2018-10-11 15:05:35,879 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.MergeBamAlignment:0:1]: job id: operations/ENja643mLBiLy-2bpY256EAgyJGInf8LKg9wcm9kdWN0aW9uUXVldWU
2018-10-11 15:06:04,982 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.MergeBamAlignment:0:1]: Status change from - to Running
2018-10-11 15:35:30,893 INFO  - 2d7df48f-0239-42a5-8508-5f47e858badd-SubWorkflowActor-SubWorkflow-PreProcessTumor:-1:1 [UUID(2d7df48f)]: Aborting workflow
2018-10-11 15:35:30,905 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.MergeBamAlignment:0:1]: PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f):PreProcessingForVariantDiscovery_GATK4.MergeBamAlignment:0:1] Aborted StandardAsyncJob(operations/ENja643mLBiLy-2bpY256EAgyJGInf8LKg9wcm9kdWN0aW9uUXVldWU)
2018-10-11 15:35:37,818 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.MergeBamAlignment:0:1]: Successfully requested cancellation of operations/ENja643mLBiLy-2bpY256EAgyJGInf8LKg9wcm9kdWN0aW9uUXVldWU
2018-10-11 16:16:14,681 INFO  - PipelinesApiAsyncBackendJobExecutionActor [UUID(2d7df48f)PreProcessingForVariantDiscovery_GATK4.MergeBamAlignment:0:1]: Status change from Running to Cancelled
2018-10-11 16:16:15,296 INFO  - 2d7df48f-0239-42a5-8508-5f47e858badd-SubWorkflowActor-SubWorkflow-PreProcessTumor:-1:1 [UUID(2d7df48f)]: WorkflowExecutionActor [UUID(2d7df48f)] aborted: PreProcessingForVariantDiscovery_GATK4.MergeBamAlignment:0:1
